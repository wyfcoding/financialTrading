syntax = "proto3";

package pricing;

import "google/protobuf/timestamp.proto";

option go_package = "github.com/fynnwu/FinancialTrading/go-api/pricing;pricing";

// 期权定价服务，负责理论价格计算及希腊字母风险指标提取。
service PricingService {
  // 计算期权理论价值。
  rpc GetOptionPrice(GetOptionPriceRequest) returns (GetOptionPriceResponse);

  // 计算期权的 Delta, Gamma, Theta, Vega, Rho 等指标。
  rpc GetGreeks(GetGreeksRequest) returns (GetGreeksResponse);
}

// 期权合约定义。
message OptionContract {
  // 标的代码。
  string symbol = 1;
  // 期权类型 (CALL/PUT)。
  string type = 2;
  // 执行价格。
  double strike_price = 3;
  // 到期日。
  google.protobuf.Timestamp expiry_date = 4;
}

// 希腊字母风险指标。
message Greeks {
  // 价格敏感度。
  double delta = 1;
  // 价格二阶敏感度。
  double gamma = 2;
  // 时间衰减敏感度。
  double theta = 3;
  // 波动率敏感度。
  double vega = 4;
  // 利率敏感度。
  double rho = 5;
}

// 定价请求。
message GetOptionPriceRequest {
  // 目标合约。
  OptionContract contract = 1;
  // 标的当前价格。
  double underlying_price = 2;
  // 预估波动率。
  double volatility = 3;
  // 无风险利率。
  double risk_free_rate = 4;
}

// 定价响应。
message GetOptionPriceResponse {
  // 理论公允价格。
  double price = 1;
  // 计算完成时间戳。
  google.protobuf.Timestamp calculation_time = 2;
}

// 希腊字母请求。
message GetGreeksRequest {
  // 目标合约。
  OptionContract contract = 1;
  // 标的价格。
  double underlying_price = 2;
  // 波动率。
  double volatility = 3;
  // 利率。
  double risk_free_rate = 4;
}

// 风险指标响应。
message GetGreeksResponse {
  // 指标结果集。
  Greeks greeks = 1;
  // 计算时间戳。
  google.protobuf.Timestamp calculation_time = 2;
}
