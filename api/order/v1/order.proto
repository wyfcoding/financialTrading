syntax = "proto3";

package order.v1;

import "google/protobuf/timestamp.proto";
import "order/v1/error_reason.proto";

option go_package = "github.com/wyfcoding/financialtrading/go-api/order/v1;v1";

service OrderService {
  rpc CreateOrder(CreateOrderRequest) returns (CreateOrderResponse) {};
  rpc CancelOrder(CancelOrderRequest) returns (CancelOrderResponse) {};
  rpc ListOrders(ListOrdersRequest) returns (ListOrdersResponse) {};
  rpc GetOrder(GetOrderRequest) returns (GetOrderResponse) {};
}

enum OrderSide {
  SIDE_UNSPECIFIED = 0;
  BUY = 1;
  SELL = 2;
}

enum OrderType {
  TYPE_UNSPECIFIED = 0;
  LIMIT = 1;
  MARKET = 2;
}

enum OrderStatus {
  STATUS_UNSPECIFIED = 0;
  PENDING = 1;
  VALIDATED = 2;
  REJECTED = 3;
  PARTIALLY_FILLED = 4;
  FILLED = 5;
  CANCELLED = 6;
}

message CreateOrderRequest {
  string user_id = 1;
  string symbol = 2;
  OrderSide side = 3;
  OrderType type = 4;
  double price = 5;
  double quantity = 6;
}

message CreateOrderResponse {
  string order_id = 1;
  OrderStatus status = 2;
}

message CancelOrderRequest {
  string order_id = 1;
  string user_id = 2; 
}

message CancelOrderResponse {
  bool success = 1;
}

message ListOrdersRequest {
  string user_id = 1;
  int32 limit = 2;
  string symbol = 3; // optional filter
  int32 offset = 4; // Added for pagination
  string status = 5; // Added for status filter
}

message Order {
  string id = 1;
  string user_id = 2;
  string symbol = 3;
  OrderSide side = 4;
  OrderType type = 5;
  double price = 6;
  double quantity = 7;
  double filled_quantity = 8;
  double average_price = 9;
  OrderStatus status = 10;
  google.protobuf.Timestamp created_at = 11;
  google.protobuf.Timestamp updated_at = 12;
}

message ListOrdersResponse {
  repeated Order orders = 1;
}

message GetOrderRequest {
  string order_id = 1;
}

message GetOrderResponse {
  Order order = 1;
}
