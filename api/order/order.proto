syntax = "proto3";

package order;

option go_package = "github.com/fynnwu/FinancialTrading/go-api/order;order";

// 订单管理服务。
service OrderService {
  // 创建订单。
  rpc CreateOrder(CreateOrderRequest) returns (OrderResponse);
  // 撤单。
  rpc CancelOrder(CancelOrderRequest) returns (OrderResponse);
  // 修改。
  rpc ModifyOrder(ModifyOrderRequest) returns (OrderResponse);
  // 详情。
  rpc GetOrder(GetOrderRequest) returns (OrderResponse);
  // 列表。
  rpc ListOrders(ListOrdersRequest) returns (ListOrdersResponse);
  // 实时推送。
  rpc SubscribeOrders(SubscribeOrdersRequest) returns (stream OrderUpdate);
}

// 下单请求。
message CreateOrderRequest {
  // 用户 ID。
  string user_id = 1;
  // 交易对。
  string symbol = 2;
  // 方向。
  string side = 3;
  // 类别。
  string order_type = 4;
  // 委托价。
  string price = 5;
  // 委托量。
  string quantity = 6;
  // 有效期策略。
  string time_in_force = 7;
  // 客户单 ID。
  string client_order_id = 8;
}

// 订单详情。
message OrderResponse {
  // 订单 ID。
  string order_id = 1;
  // 用户 ID。
  string user_id = 2;
  // 交易对。
  string symbol = 3;
  // 方向。
  string side = 4;
  // 类别。
  string order_type = 5;
  // 委托价。
  string price = 6;
  // 委托量。
  string quantity = 7;
  // 成交量。
  string filled_quantity = 8;
  // 状态。
  string status = 9;
  // 有效期。
  string time_in_force = 10;
  // 建立时间。
  int64 created_at = 11;
  // 更新时间。
  int64 updated_at = 12;
  // 异常消息。
  string error_message = 13;
}

// 撤单请求。
message CancelOrderRequest {
  // 订单 ID。
  string order_id = 1;
  // 用户 ID。
  string user_id = 2;
}

// 修改请求。
message ModifyOrderRequest {
  // 订单 ID。
  string order_id = 1;
  // 用户 ID。
  string user_id = 2;
  // 价格。
  string price = 3;
  // 数量。
  string quantity = 4;
}

// 查询请求。
message GetOrderRequest {
  // 订单 ID。
  string order_id = 1;
  // 用户 ID。
  string user_id = 2;
}

// 列表请求。
message ListOrdersRequest {
  // 用户 ID。
  string user_id = 1;
  // 交易对筛选。
  string symbol = 2;
  // 状态筛选。
  string status = 3;
  // 页码。
  int32 page = 4;
  // 每页大小。
  int32 page_size = 5;
}

// 列表响应。
message ListOrdersResponse {
  // 记录序列。
  repeated OrderResponse orders = 1;
  // 总笔数。
  int64 total = 2;
  // 当前页。
  int32 page = 3;
  // 分页大小。
  int32 page_size = 4;
}

// 订阅请求。
message SubscribeOrdersRequest {
  // 用户 ID。
  string user_id = 1;
  // 标的列表。
  repeated string symbols = 2;
}

// 状态更新推送。
message OrderUpdate {
  // 订单 ID。
  string order_id = 1;
  // 用户 ID。
  string user_id = 2;
  // 交易对。
  string symbol = 3;
  // 最新状态。
  string status = 4;
  // 当前成交量。
  string filled_quantity = 5;
  // 更新时间。
  int64 timestamp = 6;
}
