apiVersion: v1
kind: Secret
metadata:
  name: {{ include "risk.fullname" . }}-secrets
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "risk.labels" . | nindent 4 }}
type: Opaque
stringData:
  # 顶级架构实践：这些值在生产环境中应由 Vault/External Secrets 动态注入，此处作为占位符
  DB_PASSWORD: {{ .Values.secrets.dbPassword | default "set-by-vault" | quote }}
  REDIS_PASSWORD: {{ .Values.secrets.redisPassword | default "set-by-vault" | quote }}
  JWT_SECRET: {{ .Values.secrets.jwtSecret | default "set-by-vault" | quote }}
  # 对 DSN 进行构建，隐藏敏感部分
  DB_DSN: "risk_user:$(DB_PASSWORD)@tcp(mysql-master.default:3306)/ecommerce_risk?charset=utf8mb4&parseTime=True&loc=Local"
